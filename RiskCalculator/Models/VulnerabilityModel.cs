using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace RiskCalculator.Models
{
    class VulnerabilityModel
    {
        public string Id { get; set; }

        public string Description { get; set; }

        public string Severity { get; set; }

        public string VectorV2 { get; set; }
        public string VectorV3 { get; set; }
    }

    /// <summary>
    /// Для конвертации полученного JSON  объекта CVE в более удобный для работы список VulnerabilityModel.
    /// </summary>
    class CveConvertor
    {
        public static List<VulnerabilityModel> GetVulnerabilities(CveModel cve)
        {
            var vulList = new List<VulnerabilityModel>();

            foreach (var item in cve.Result.CVE_Items)
            {
                vulList.Add(new VulnerabilityModel
                {
                    Id = item.Cve.Meta.Id,
                    Description = item.Cve.Description.description_data[0].Value,
                    Severity = item.Impact.baseMetricV3.impactScore
                }); 
            }

            return vulList;
        }
    }
}
